<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register â€” Ghostlet</title>
<style>
  :root{--glow:#ff6aff}
  body{margin:0;font-family:Segoe UI,Arial;background:linear-gradient(180deg,#0d0d1a,#1a1a2e);color:#eee;display:flex;justify-content:center;align-items:center;height:100vh}
  .card{background:#242444;padding:24px;border-radius:16px;border:2px solid var(--glow);width:320px;box-shadow:0 0 12px var(--glow)}
  h1{text-align:center;color:var(--glow);margin-bottom:16px}
  label{display:block;margin-top:12px;margin-bottom:4px;font-weight:600;color:#ccc}
  input{width:100%;padding:10px;border-radius:8px;border:none;background:#2b2b44;color:#eee;}
  button{width:100%;padding:10px;margin-top:16px;border:none;border-radius:8px;background:var(--glow);color:#fff;font-weight:700;cursor:pointer}
  button:hover{opacity:0.85}
  .link{color:var(--glow);text-decoration:none;display:block;text-align:center;margin-top:12px}
</style>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
<div class="card">
  <h1>Register</h1>
  <label>Username</label>
  <input type="text" id="username" placeholder="Choose a username">
  <label>Email</label>
  <input type="email" id="email" placeholder="Email">
  <label>Password</label>
  <input type="password" id="password" placeholder="Password">
  <button id="registerBtn">Register</button>
  <a href="login.html" class="link">Already have an account? Login</a>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBLPQtq39tEcha66rw_ovWa5-I3Nl1qyos",
  authDomain: "ghostlet-98357.firebaseapp.com",
  projectId: "ghostlet-98357",
  storageBucket: "ghostlet-98357.appspot.com",
  messagingSenderId: "843012219969",
  appId: "1:843012219969:web:9e3037578726debf2212c0"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

document.getElementById('registerBtn').addEventListener('click', async () => {
  const username = document.getElementById('username').value.trim();
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;

  if(!username || !email || !password){alert("Fill all fields"); return;}

  try {
    const userCredential = await auth.createUserWithEmailAndPassword(email,password);
    const uid = userCredential.user.uid;

    // Save initial user data
    await db.collection("users").doc(uid).set({
      username,
      tokens: 0,
      packsOpened: 0,
      blooks: [],
      messagesSent: 0,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    });

    alert("Account created!");
    window.location.href = "stats.html";
  } catch(err){
    alert(err.message);
  }
});
</script>
</body>
</html>
