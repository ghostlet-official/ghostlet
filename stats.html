<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ghostlet â€” Stats</title>
  <link rel="stylesheet" href="assets/style.css">
  <style>
    .container { max-width: 800px; margin: 24px auto; color: #eee; font-family: Segoe UI, Arial; }
    .topbar { display:flex; justify-content:space-between; align-items:center; padding:12px 18px; background:#242444; box-shadow:0 0 12px #ff6aff; border-bottom:2px solid #ff6aff; position:sticky; top:0; }
    .brand { color:#ff6aff; font-weight:800; text-decoration:none; }
    .stat-card { background:#2b2b44; padding:16px; border-radius:12px; margin:12px 0; border:2px solid rgba(255,106,255,0.06); }
    .stat-title { font-weight:700; color:#ff6aff; margin-bottom:6px; }
  </style>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBLPQtq39tEcha66rw_ovWa5-I3Nl1qyos",
      authDomain: "ghostlet-98357.firebaseapp.com",
      projectId: "ghostlet-98357",
      storageBucket: "ghostlet-98357.appspot.com",
      messagingSenderId: "843012219969",
      appId: "1:843012219969:web:9e3037578726debf2212c0"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    window.addEventListener('DOMContentLoaded', () => {
      const usernameEl = document.getElementById('username');
      const tokensEl = document.getElementById('tokens');
      const packsEl = document.getElementById('packs');
      const blooksEl = document.getElementById('blooks');
      const messagesEl = document.getElementById('messages');

      auth.onAuthStateChanged(async user => {
        if (!user) {
          window.location.href = "login.html"; // redirect if not logged in
          return;
        }

        usernameEl.textContent = user.displayName || user.email;

        // Load stats from Firestore
        const statsDoc = await db.collection('users').doc(user.uid).get();
        const stats = statsDoc.exists ? statsDoc.data() : {};

        tokensEl.textContent = stats.tokens || 0;
        packsEl.textContent = stats.packsOpened || 0;
        blooksEl.textContent = stats.blooksOwned || 0;
        messagesEl.textContent = stats.messagesSent || 0;
      });
    });
  </script>
</head>
<body>
  <div class="topbar">
    <a class="brand" href="home.html">Ghostlet</a>
    <div>
      <button onclick="location.href='stats.html'">Stats</button>
      <button onclick="location.href='chat.html'">Chat</button>
      <button onclick="location.href='market.html'">Market</button>
      <button onclick="location.href='blooks.html'">Blooks</button>
      <button onclick="location.href='settings.html'">Settings</button>
      <button id="logoutBtn">Logout</button>
    </div>
  </div>

  <div class="container">
    <div class="stat-card">
      <div class="stat-title">Username:</div>
      <div id="username">Loading...</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Tokens:</div>
      <div id="tokens">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Packs Opened:</div>
      <div id="packs">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Blooks Owned:</div>
      <div id="blooks">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-title">Messages Sent:</div>
      <div id="messages">0</div>
    </div>
  </div>

  <script>
    document.getElementById('logoutBtn').addEventListener('click', () => {
      auth.signOut().then(() => window.location.href = 'login.html');
    });
  </script>
</body>
</html>
