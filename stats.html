<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ghostlet - Stats</title>

<link href="https://fonts.googleapis.com/css2?family=Titan+One&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

<style>
body {
  margin: 0;
  font-family: Nunito, sans-serif;
  background: linear-gradient(rgba(255,128,0,0.15) 1px, transparent 1px),
              linear-gradient(90deg, rgba(255,191,0,0.15) 1px, transparent 1px),
              linear-gradient(135deg, rgb(255,128,0), rgb(255,191,0));
  background-size: 40px 40px;
  color: white;
}

.header {
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  padding: 15px 20px;
  display: flex;
  justify-content: space-between;
  border-bottom: 2px solid rgba(255,255,255,0.15);
}

.logo {
  font-family: Titan One;
  font-size: 2rem;
}

.container {
  margin: 30px auto;
  width: 90%;
  max-width: 900px;
  background: rgba(255,255,255,0.08);
  border-radius: 20px;
  padding: 25px;
  backdrop-filter: blur(12px);
  border: 2px solid rgba(255,255,255,0.15);
}

.profile-row {
  display: flex;
  align-items: center;
  gap: 20px;
}

.pfp {
  width: 110px;
  height: 110px;
  border-radius: 18px;
  background: rgba(0,0,0,0.25);
  border: 2px solid rgba(255,255,255,0.3);
  object-fit: contain;
}

.username {
  font-size: 2rem;
  font-weight: 700;
}

.badges-row {
  margin-top: 5px;
}

.badges-row img {
  width: 34px;
  margin-right: 5px;
}

.stats-box {
  margin-top: 30px;
  background: rgba(255,255,255,0.10);
  padding: 18px;
  border-radius: 15px;
  border: 2px solid rgba(255,255,255,0.2);
}

.stat {
  font-size: 1.4rem;
  margin: 10px 0;
  display: flex;
  justify-content: space-between;
}
</style>
</head>

<body>
<div class="header">
  <div class="logo">Ghostlet</div>
  <a href="home.html" style="color:white;text-decoration:none;font-weight:700;">Home</a>
</div>

<div class="container">

  <div class="profile-row">
    <img id="pfp" class="pfp" src="">
    <div>
      <div id="username" class="username">Loading...</div>
      <div id="badges" class="badges-row"></div>
    </div>
  </div>

  <div class="stats-box">
    <div class="stat"><span>Tokens:</span> <span id="tokens">0</span></div>
    <div class="stat"><span>Packs Opened:</span> <span id="packsOpened">0</span></div>
    <div class="stat"><span>Blooks Owned:</span> <span id="blooksOwned">0</span></div>
    <div class="stat"><span>Messages Sent:</span> <span id="messagesSent">0</span></div>
  </div>

</div>

<script>
// ---------------------------
// FIREBASE INIT
// ---------------------------
const firebaseConfig = {
  apiKey: "AIzaSyBLPQtq39tEcha66rw_ovWa5-I3Nl1qyos",
  authDomain: "ghostlet-98357.firebaseapp.com",
  projectId: "ghostlet-98357",
  storageBucket: "ghostlet-98357.firebasestorage.app",
  messagingSenderId: "843012219969",
  appId: "1:843012219969:web:9e3037578726debf2212c0"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();


// ---------------------------
// LOAD STATS
// ---------------------------
auth.onAuthStateChanged(async user => {
  if (!user) {
    window.location.href = "login.html";
    return;
  }

  const uid = user.uid;
  const ref = db.collection("users").doc(uid);
  const doc = await ref.get();

  if (!doc.exists) return;

  const data = doc.data();

  document.getElementById("username").textContent = data.username || "Unknown";

  // pfp
  if (data.pfp) {
    document.getElementById("pfp").src = data.pfp;
  }

  // stats
  document.getElementById("tokens").textContent = data.tokens || 0;
  document.getElementById("packsOpened").textContent = data.packsOpened || 0;
  document.getElementById("messagesSent").textContent = data.messagesSent || 0;

  const owned = data.ownedBlooks || [];
  document.getElementById("blooksOwned").textContent = owned.length;

});
</script>

</body>
</html>
