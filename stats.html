<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ghostlet — Stats</title>

<style>
  :root { --glow:#ff6aff }

  body {
    margin:0;
    font-family:'Segoe UI', sans-serif;
    background:linear-gradient(180deg,#0d0d1a,#1a1a2e);
    color:#eee;
  }

  .topbar {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:12px 18px;
    background:#2b2b44;
    box-shadow:0 0 12px var(--glow);
    border-bottom:2px solid var(--glow);
    position:sticky;
    top:0;
    z-index:100;
  }
  .brand { color:var(--glow); font-weight:800; text-decoration:none }

  button {
    background:var(--glow);
    border:none;
    color:#fff;
    padding:8px 14px;
    border-radius:8px;
    cursor:pointer;
    margin-left:6px;
  }

  .container {
    max-width:900px;
    margin:40px auto;
    padding:0 20px;
  }

  .profile-section {
    display:flex;
    align-items:center;
    background:#2b2b44;
    padding:20px;
    border-radius:12px;
    box-shadow:0 0 12px #0008;
    border:2px solid #ff6aff33;
  }

  .pfp {
    width:110px;
    height:110px;
    border-radius:12px;
    background:#111;
    border:2px solid var(--glow);
    object-fit:contain;
    margin-right:20px;
  }

  .username {
    font-size:1.9rem;
    font-weight:800;
    color:var(--glow);
  }

  .badges {
    margin-top:6px;
  }

  .badge {
    display:inline-block;
    background:#444;
    padding:6px 10px;
    border-radius:8px;
    margin-right:6px;
    font-size:0.85rem;
    border:1px solid #777;
  }

  .stats-box {
    margin-top:25px;
    background:#2b2b44;
    padding:20px;
    border-radius:12px;
    border:2px solid #ff6aff33;
    box-shadow:0 0 12px #0008;
  }

  .stat {
    font-size:1.3rem;
    margin-bottom:10px;
  }

</style>
</head>
<body>

<!-- TOP NAV -->
<div class="topbar">
  <a class="brand" href="home.html">Ghostlet</a>
  <div>
    <button onclick="location.href='stats.html'">Stats</button>
    <button onclick="location.href='chat.html'">Chat</button>
    <button onclick="location.href='market.html'">Market</button>
    <button onclick="location.href='blooks.html'">Blooks</button>
    <button onclick="location.href='settings.html'">Settings</button>
    <button id="logoutBtn">Logout</button>
  </div>
</div>


<div class="container">

  <!-- USER PROFILE -->
  <div class="profile-section">
    <img id="pfp" class="pfp" src="https://i.ibb.co/0FQG7kF/friendly-ghost.png">
    
    <div>
      <div id="username" class="username">Loading...</div>
      <div id="badges" class="badges"></div>
    </div>
  </div>

  <!-- STATS -->
  <div class="stats-box">
    <div class="stat">Tokens: <span id="tokens">0</span></div>
    <div class="stat">Packs Opened: <span id="packsOpened">0</span></div>
    <div class="stat">Blooks Owned: <span id="blooksOwned">0</span></div>
    <div class="stat">Messages Sent: <span id="messagesSent">0</span></div>
  </div>

</div>


<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBLPQtq39tEcha66rw_ovWa5-I3Nl1qyos",
  authDomain: "ghostlet-98357.firebaseapp.com",
  projectId: "ghostlet-98357",
  storageBucket: "ghostlet-98357.firebasestorage.app",
  messagingSenderId: "843012219969",
  appId: "1:843012219969:web:9e3037578726debf2212c0"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(async (user) => {
  if (!user) {
    window.location.href = "login.html";
    return;
  }

  const ref = db.collection("users").doc(user.uid);
  const snap = await ref.get();

  if (!snap.exists) return;

  const u = snap.data();

  // ⁃––––––– PROFILE ––––––––
  document.getElementById("username").textContent = u.username;
  document.getElementById("pfp").src = u.pfp || "https://i.ibb.co/0FQG7kF/friendly-ghost.png";

  // Badges
  const badges = document.getElementById("badges");
  if (u.badges && u.badges.length > 0) {
    u.badges.forEach(b => {
      const badge = document.createElement("div");
      badge.className = "badge";
      badge.textContent = b;
      badges.appendChild(badge);
    });
  }

  // ⁃––––––– STATS ––––––––
  document.getElementById("tokens").textContent = u.tokens || 0;
  document.getElementById("packsOpened").textContent = u.packsOpened || 0;
  document.getElementById("blooksOwned").textContent = u.blooks ? u.blooks.length : 0;
  document.getElementById("messagesSent").textContent = u.messagesSent || 0;

});

// Logout
document.getElementById("logoutBtn").onclick = () => {
  auth.signOut();
  window.location.href = "login.html";
};

</script>

</body>
</html>
